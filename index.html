<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2575.6">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
  </style>
</head>
<body>
<p class="p1">&lt;!DOCTYPE html&gt;</p>
<p class="p1">&lt;html lang="en"&gt;</p>
<p class="p1">&lt;head&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;meta charset="UTF-8"&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;title&gt;Multi-Model Implied P/E Calculator&lt;/title&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;script src="https://cdn.tailwindcss.com"&gt;&lt;/script&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;link rel="preconnect" href="https://fonts.googleapis.com"&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;link rel="preconnect" href="https://fonts.gstatic.com" crossorigin&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;display=swap" rel="stylesheet"&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;style&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>body {</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-family: 'Inter', sans-serif;</p>
<p class="p1"><span class="Apple-converted-space">            </span>-webkit-font-smoothing: antialiased;</p>
<p class="p1"><span class="Apple-converted-space">            </span>-moz-osx-font-smoothing: grayscale;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>.card {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background-color: white;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 0.75rem;</p>
<p class="p1"><span class="Apple-converted-space">            </span>box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 2rem;</p>
<p class="p1"><span class="Apple-converted-space">            </span>transition: all 0.3s ease;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>.input-group {</p>
<p class="p1"><span class="Apple-converted-space">            </span>display: grid;</p>
<p class="p1"><span class="Apple-converted-space">            </span>grid-template-columns: 1fr 100px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>gap: 1rem;</p>
<p class="p1"><span class="Apple-converted-space">            </span>align-items: center;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>.input-group label {</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-weight: 500;</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #374151;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>.input-field {</p>
<p class="p1"><span class="Apple-converted-space">            </span>width: 100%;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 0.5rem 0.75rem;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border: 1px solid #D1D5DB;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 0.375rem;</p>
<p class="p1"><span class="Apple-converted-space">            </span>text-align: right;</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-size: 1rem;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>.slider {</p>
<p class="p1"><span class="Apple-converted-space">            </span>-webkit-appearance: none;</p>
<p class="p1"><span class="Apple-converted-space">            </span>width: 100%;</p>
<p class="p1"><span class="Apple-converted-space">            </span>height: 8px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: #D1D5DB;</p>
<p class="p1"><span class="Apple-converted-space">            </span>outline: none;</p>
<p class="p1"><span class="Apple-converted-space">            </span>opacity: 0.7;</p>
<p class="p1"><span class="Apple-converted-space">            </span>transition: opacity .2s;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 9999px;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>.slider:hover {</p>
<p class="p1"><span class="Apple-converted-space">            </span>opacity: 1;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>.slider::-webkit-slider-thumb {</p>
<p class="p1"><span class="Apple-converted-space">            </span>-webkit-appearance: none;</p>
<p class="p1"><span class="Apple-converted-space">            </span>appearance: none;</p>
<p class="p1"><span class="Apple-converted-space">            </span>width: 20px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>height: 20px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: #3B82F6;</p>
<p class="p1"><span class="Apple-converted-space">            </span>cursor: pointer;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 50%;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>.slider::-moz-range-thumb {</p>
<p class="p1"><span class="Apple-converted-space">            </span>width: 20px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>height: 20px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: #3B82F6;</p>
<p class="p1"><span class="Apple-converted-space">            </span>cursor: pointer;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 50%;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>.highlight-cell {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background-color: #BFDBFE;</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-weight: 700;</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #1E40AF;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>.error-message {</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #EF4444;</p>
<p class="p1"><span class="Apple-converted-space">            </span>background-color: #FEE2E2;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 0.75rem 1.25rem;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 0.5rem;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border: 1px solid #FCA5A5;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-top: 1.5rem;</p>
<p class="p1"><span class="Apple-converted-space">            </span>text-align: center;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>.tab-btn {</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 0.75rem 1.5rem;</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-weight: 600;</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #4B5563;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-bottom: 3px solid transparent;</p>
<p class="p1"><span class="Apple-converted-space">            </span>cursor: pointer;</p>
<p class="p1"><span class="Apple-converted-space">            </span>transition: all 0.2s ease-in-out;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>.tab-btn.active {</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #3B82F6;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-bottom-color: #3B82F6;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>.formula {</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-family: 'Courier New', Courier, monospace;</p>
<p class="p1"><span class="Apple-converted-space">            </span>background-color: #F3F4F6;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 0.5rem;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 0.25rem;</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #4B5563;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/style&gt;</p>
<p class="p1">&lt;/head&gt;</p>
<p class="p1">&lt;body class="bg-gray-50 text-gray-800"&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div class="container mx-auto p-4 sm:p-6 lg:p-8 max-w-6xl"&gt;</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;header class="text-center mb-8"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;h1 class="text-3xl sm:text-4xl font-bold text-gray-900"&gt;Implied P/E Calculator&lt;/h1&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/header&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;!-- Tab Navigation --&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div class="flex border-b border-gray-200 mb-8 justify-center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;button class="tab-btn active" data-model="two-stage"&gt;Two-Stage Model&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;button class="tab-btn" data-model="single-stage"&gt;Single-Stage Compound Model&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;!-- Two-Stage Model Content --&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div id="two-stage-model" class="model-content"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="grid grid-cols-1 lg:grid-cols-3 gap-8"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;!-- Input Panel --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="lg:col-span-1"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="card sticky top-8"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;h2 class="text-xl font-semibold mb-6 border-b pb-3"&gt;Input Parameters&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;form id="two-stage-form" class="space-y-6"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div class="input-group"&gt;&lt;label for="ts-roic"&gt;ROIC&lt;/label&gt;&lt;input type="number" id="ts-roic" value="15" step="0.1" class="input-field"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;input type="range" id="ts-roic-slider" min="0" max="50" value="15" step="0.1" class="slider mt-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div class="input-group"&gt;&lt;label for="ts-g1"&gt;Growth Rate - Stage 1 (g1)&lt;/label&gt;&lt;input type="number" id="ts-g1" value="10" step="0.1" class="input-field"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;input type="range" id="ts-g1-slider" min="0" max="30" value="10" step="0.1" class="slider mt-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div class="input-group"&gt;&lt;label for="ts-t"&gt;Duration of Stage 1 (T)&lt;/label&gt;&lt;input type="number" id="ts-t" value="5" step="1" class="input-field"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;input type="range" id="ts-t-slider" min="1" max="20" value="5" step="1" class="slider mt-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div class="input-group"&gt;&lt;label for="ts-g2"&gt;Perpetual Growth Rate (g2)&lt;/label&gt;&lt;input type="number" id="ts-g2" value="3" step="0.1" class="input-field"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;input type="range" id="ts-g2-slider" min="0" max="10" value="3" step="0.1" class="slider mt-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div class="input-group"&gt;&lt;label for="ts-wacc"&gt;WACC&lt;/label&gt;&lt;input type="number" id="ts-wacc" value="8" step="0.1" class="input-field"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;input type="range" id="ts-wacc-slider" min="1" max="20" value="8" step="0.1" class="slider mt-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/form&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;!-- Output Panel --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="lg:col-span-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="card"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;h2 class="text-xl font-semibold mb-4 border-b pb-3"&gt;Calculation Results&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div id="ts-error-container" class="hidden"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div id="ts-results-container"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="text-center py-8"&gt;&lt;p class="text-lg text-gray-600"&gt;Implied P/E&lt;/p&gt;&lt;p id="ts-pe-result" class="text-5xl font-bold text-blue-600 my-2"&gt;--&lt;/p&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="mt-8"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;h3 class="text-lg font-semibold mb-4 text-center"&gt;Sensitivity Analysis (vs WACC &amp; g2)&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div id="ts-sensitivity-table-container" class="overflow-x-auto"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                             </span>&lt;div class="mt-6 pt-4 border-t border-gray-200 space-y-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;p class="text-xs text-gray-500 italic"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;strong&gt;Method:&lt;/strong&gt; Implied P/E is the sum of the present value of Free Cash Flows to the Firm (FCFF) during the high-growth period (Stage 1) and the present value of the terminal value.</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;p class="text-xs text-gray-500 italic"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;strong&gt;Formula:&lt;/strong&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;span class="block formula mt-1"&gt;P/E = PV(Stage 1 FCFF) + PV(Terminal Value)&lt;br&gt;where Terminal Value = FCFF_T+1 / (WACC - g2)&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;!-- Single-Stage Model Content --&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div id="single-stage-model" class="model-content hidden"&gt;</p>
<p class="p1"><span class="Apple-converted-space">             </span>&lt;div class="grid grid-cols-1 lg:grid-cols-3 gap-8"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;!-- Input Panel --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="lg:col-span-1"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="card sticky top-8"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;h2 class="text-xl font-semibold mb-6 border-b pb-3"&gt;Input Parameters&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;form id="single-stage-form" class="space-y-6"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div class="input-group"&gt;&lt;label for="ss-roic"&gt;ROIC&lt;/label&gt;&lt;input type="number" id="ss-roic" value="20" step="0.1" class="input-field"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;input type="range" id="ss-roic-slider" min="0" max="50" value="20" step="0.1" class="slider mt-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div class="input-group"&gt;&lt;label for="ss-g"&gt;Growth Rate (g)&lt;/label&gt;&lt;input type="number" id="ss-g" value="15" step="0.1" class="input-field"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;input type="range" id="ss-g-slider" min="0" max="40" value="15" step="0.1" class="slider mt-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div class="input-group"&gt;&lt;label for="ss-t"&gt;Duration (T)&lt;/label&gt;&lt;input type="number" id="ss-t" value="10" step="1" class="input-field"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;input type="range" id="ss-t-slider" min="1" max="30" value="10" step="1" class="slider mt-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div class="input-group"&gt;&lt;label for="ss-wacc"&gt;WACC&lt;/label&gt;&lt;input type="number" id="ss-wacc" value="10" step="0.1" class="input-field"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;input type="range" id="ss-wacc-slider" min="1" max="20" value="10" step="0.1" class="slider mt-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/form&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;!-- Output Panel --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="lg:col-span-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="card"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;h2 class="text-xl font-semibold mb-4 border-b pb-3"&gt;Calculation Results&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div id="ss-error-container" class="hidden"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div id="ss-results-container"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="text-center py-8"&gt;&lt;p class="text-lg text-gray-600"&gt;Implied P/E&lt;/p&gt;&lt;p id="ss-pe-result" class="text-5xl font-bold text-blue-600 my-2"&gt;--&lt;/p&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="mt-8"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;h3 class="text-lg font-semibold mb-4 text-center"&gt;Sensitivity Analysis (vs WACC &amp; Growth Rate)&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div id="ss-sensitivity-table-container" class="overflow-x-auto"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="mt-6 pt-4 border-t border-gray-200 space-y-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;p class="text-xs text-gray-500 italic"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;strong&gt;Method:&lt;/strong&gt; Implied P/E is the sum of the present value of FCFF during the explicit growth period and the present value of the residual value.</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;p class="text-xs text-gray-500 italic"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;strong&gt;Formula:&lt;/strong&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;span class="block formula mt-1"&gt;P/E = PV(FCFF) + PV(Residual Value)&lt;br&gt;where Residual Value = NOPAT_T / WACC&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;footer class="text-center mt-12 text-sm text-gray-500"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;p&gt;This is a valuation tool for reference purposes only.&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/footer&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;script&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>document.addEventListener('DOMContentLoaded', () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">            </span>// --- Generic Helper Functions ---</p>
<p class="p1"><span class="Apple-converted-space">            </span>const linkInputs = (numInput, sliderInput, callback) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>numInput.addEventListener('input', (e) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>sliderInput.value = e.target.value;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>callback();</p>
<p class="p1"><span class="Apple-converted-space">                </span>});</p>
<p class="p1"><span class="Apple-converted-space">                </span>sliderInput.addEventListener('input', (e) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>numInput.value = e.target.value;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>callback();</p>
<p class="p1"><span class="Apple-converted-space">                </span>});</p>
<p class="p1"><span class="Apple-converted-space">            </span>};</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>const displayResult = (element, value) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>if (value &amp;&amp; isFinite(value)) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>element.textContent = value.toFixed(2);</p>
<p class="p1"><span class="Apple-converted-space">                    </span>element.classList.toggle('text-red-600', value &lt; 0);</p>
<p class="p1"><span class="Apple-converted-space">                    </span>element.classList.toggle('text-blue-600', value &gt;= 0);</p>
<p class="p1"><span class="Apple-converted-space">                </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>element.textContent = '--';</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>};</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>const showError = (container, message) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>container.textContent = message;</p>
<p class="p1"><span class="Apple-converted-space">                </span>container.classList.remove('hidden');</p>
<p class="p1"><span class="Apple-converted-space">            </span>};</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>const hideError = (container) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>container.classList.add('hidden');</p>
<p class="p1"><span class="Apple-converted-space">            </span>};</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// --- Two-Stage Model Logic ---</p>
<p class="p1"><span class="Apple-converted-space">            </span>const ts = {</p>
<p class="p1"><span class="Apple-converted-space">                </span>form: document.getElementById('two-stage-form'),</p>
<p class="p1"><span class="Apple-converted-space">                </span>peResultEl: document.getElementById('ts-pe-result'),</p>
<p class="p1"><span class="Apple-converted-space">                </span>tableContainer: document.getElementById('ts-sensitivity-table-container'),</p>
<p class="p1"><span class="Apple-converted-space">                </span>errorContainer: document.getElementById('ts-error-container'),</p>
<p class="p1"><span class="Apple-converted-space">                </span>resultsContainer: document.getElementById('ts-results-container'),</p>
<p class="p1"><span class="Apple-converted-space">                </span>inputs: {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>roic: { num: document.getElementById('ts-roic'), slider: document.getElementById('ts-roic-slider') },</p>
<p class="p1"><span class="Apple-converted-space">                    </span>g1: { num: document.getElementById('ts-g1'), slider: document.getElementById('ts-g1-slider') },</p>
<p class="p1"><span class="Apple-converted-space">                    </span>t: { num: document.getElementById('ts-t'), slider: document.getElementById('ts-t-slider') },</p>
<p class="p1"><span class="Apple-converted-space">                    </span>g2: { num: document.getElementById('ts-g2'), slider: document.getElementById('ts-g2-slider') },</p>
<p class="p1"><span class="Apple-converted-space">                    </span>wacc: { num: document.getElementById('ts-wacc'), slider: document.getElementById('ts-wacc-slider') },</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>};</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>function calculateTwoStagePE(roic, g1, t, g2, wacc) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>roic /= 100; g1 /= 100; g2 /= 100; wacc /= 100;</p>
<p class="p1"><span class="Apple-converted-space">                </span>if (wacc &lt;= g2) return { error: 'WACC must be greater than Perpetual Growth Rate (g2).' };</p>
<p class="p1"><span class="Apple-converted-space">                </span>if (roic &lt;= 0) return { error: 'ROIC must be a positive number.' };</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>const rr1 = g1 / roic;</p>
<p class="p1"><span class="Apple-converted-space">                </span>let pvStage1 = 0;</p>
<p class="p1"><span class="Apple-converted-space">                </span>for (let i = 1; i &lt;= t; i++) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>pvStage1 += (Math.pow(1 + g1, i) * (1 - rr1)) / Math.pow(1 + wacc, i);</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p1"><span class="Apple-converted-space">                </span>const rr2 = g2 / roic;</p>
<p class="p1"><span class="Apple-converted-space">                </span>const nopat_t1_ratio = Math.pow(1 + g1, t) * (1 + g2);</p>
<p class="p1"><span class="Apple-converted-space">                </span>const fcff_t1_ratio = nopat_t1_ratio * (1 - rr2);</p>
<p class="p1"><span class="Apple-converted-space">                </span>const terminalValueT = fcff_t1_ratio / (wacc - g2);</p>
<p class="p1"><span class="Apple-converted-space">                </span>const pvTerminalValue = terminalValueT / Math.pow(1 + wacc, t);</p>
<p class="p1"><span class="Apple-converted-space">                </span>return { value: pvStage1 + pvTerminalValue };</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>function generateTwoStageSensitivityTable(params) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const { roic, g1, t, g2, wacc } = params;</p>
<p class="p1"><span class="Apple-converted-space">                </span>const waccSteps = [-1, -0.5, 0, 0.5, 1];</p>
<p class="p1"><span class="Apple-converted-space">                </span>const g2Steps = [-0.5, -0.25, 0, 0.25, 0.5];</p>
<p class="p1"><span class="Apple-converted-space">                </span>let tableHtml = '&lt;table class="w-full border-collapse text-center"&gt;';</p>
<p class="p1"><span class="Apple-converted-space">                </span>tableHtml += '&lt;thead&gt;&lt;tr class="bg-gray-100"&gt;&lt;th class="p-2 border font-semibold"&gt;WACC \\ g2&lt;/th&gt;';</p>
<p class="p1"><span class="Apple-converted-space">                </span>g2Steps.forEach(step =&gt; { tableHtml += `&lt;th class="p-2 border font-semibold"&gt;${(g2 + step).toFixed(2)}%&lt;/th&gt;`; });</p>
<p class="p1"><span class="Apple-converted-space">                </span>tableHtml += '&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;';</p>
<p class="p1"><span class="Apple-converted-space">                </span>waccSteps.forEach(waccStep =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const currentWacc = wacc + waccStep;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>tableHtml += `&lt;tr&gt;&lt;td class="p-2 border font-semibold bg-gray-100"&gt;${currentWacc.toFixed(2)}%&lt;/td&gt;`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>g2Steps.forEach(g2Step =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>const currentG2 = g2 + g2Step;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>const result = calculateTwoStagePE(roic, g1, t, currentG2, currentWacc);</p>
<p class="p1"><span class="Apple-converted-space">                        </span>let val = (result.value &amp;&amp; isFinite(result.value) &amp;&amp; result.value &gt; 0) ? result.value.toFixed(2) : 'N/A';</p>
<p class="p1"><span class="Apple-converted-space">                        </span>tableHtml += `&lt;td class="p-2 border ${waccStep === 0 &amp;&amp; g2Step === 0 ? 'highlight-cell' : ''}"&gt;${val}&lt;/td&gt;`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>});</p>
<p class="p1"><span class="Apple-converted-space">                    </span>tableHtml += '&lt;/tr&gt;';</p>
<p class="p1"><span class="Apple-converted-space">                </span>});</p>
<p class="p1"><span class="Apple-converted-space">                </span>tableHtml += '&lt;/tbody&gt;&lt;/table&gt;';</p>
<p class="p1"><span class="Apple-converted-space">                </span>ts.tableContainer.innerHTML = tableHtml;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>function updateTwoStageUI() {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const params = {};</p>
<p class="p1"><span class="Apple-converted-space">                </span>for (const key in ts.inputs) { params[key] = parseFloat(ts.inputs[key].num.value); }</p>
<p class="p1"><span class="Apple-converted-space">                </span>const result = calculateTwoStagePE(params.roic, params.g1, params.t, params.g2, params.wacc);</p>
<p class="p1"><span class="Apple-converted-space">                </span>if (result.error) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>showError(ts.errorContainer, result.error);</p>
<p class="p1"><span class="Apple-converted-space">                    </span>ts.resultsContainer.classList.add('hidden');</p>
<p class="p1"><span class="Apple-converted-space">                </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>hideError(ts.errorContainer);</p>
<p class="p1"><span class="Apple-converted-space">                    </span>ts.resultsContainer.classList.remove('hidden');</p>
<p class="p1"><span class="Apple-converted-space">                    </span>displayResult(ts.peResultEl, result.value);</p>
<p class="p1"><span class="Apple-converted-space">                    </span>generateTwoStageSensitivityTable(params);</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// --- Single-Stage Model Logic ---</p>
<p class="p1"><span class="Apple-converted-space">            </span>const ss = {</p>
<p class="p1"><span class="Apple-converted-space">                </span>form: document.getElementById('single-stage-form'),</p>
<p class="p1"><span class="Apple-converted-space">                </span>peResultEl: document.getElementById('ss-pe-result'),</p>
<p class="p1"><span class="Apple-converted-space">                </span>tableContainer: document.getElementById('ss-sensitivity-table-container'),</p>
<p class="p1"><span class="Apple-converted-space">                </span>errorContainer: document.getElementById('ss-error-container'),</p>
<p class="p1"><span class="Apple-converted-space">                </span>resultsContainer: document.getElementById('ss-results-container'),</p>
<p class="p1"><span class="Apple-converted-space">                </span>inputs: {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>roic: { num: document.getElementById('ss-roic'), slider: document.getElementById('ss-roic-slider') },</p>
<p class="p1"><span class="Apple-converted-space">                    </span>g: { num: document.getElementById('ss-g'), slider: document.getElementById('ss-g-slider') },</p>
<p class="p1"><span class="Apple-converted-space">                    </span>t: { num: document.getElementById('ss-t'), slider: document.getElementById('ss-t-slider') },</p>
<p class="p1"><span class="Apple-converted-space">                    </span>wacc: { num: document.getElementById('ss-wacc'), slider: document.getElementById('ss-wacc-slider') },</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>};</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>function calculateSingleStagePE(roic, g, t, wacc) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>// Convert percentages to decimals</p>
<p class="p1"><span class="Apple-converted-space">                </span>roic /= 100;<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>g /= 100;<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>wacc /= 100;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>// Input Validation</p>
<p class="p1"><span class="Apple-converted-space">                </span>if (roic &lt;= 0) return { error: 'ROIC must be a positive number.' };</p>
<p class="p1"><span class="Apple-converted-space">                </span>if (wacc &lt;= 0) return { error: 'WACC must be a positive number.' };</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>// --- Part 1: PV of FCFF during the explicit period (T years) ---</p>
<p class="p1"><span class="Apple-converted-space">                </span>const rr = g / roic;</p>
<p class="p1"><span class="Apple-converted-space">                </span>let pvFcfPeriod = 0;</p>
<p class="p1"><span class="Apple-converted-space">                </span>for (let i = 1; i &lt;= t; i++) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const fcff_ratio = Math.pow(1 + g, i) * (1 - rr);</p>
<p class="p1"><span class="Apple-converted-space">                    </span>pvFcfPeriod += fcff_ratio / Math.pow(1 + wacc, i);</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>// --- Part 2: PV of Residual Value ---</p>
<p class="p1"><span class="Apple-converted-space">                </span>// Residual Value = (NOPAT at T) / WACC, discounted to year 0.</p>
<p class="p1"><span class="Apple-converted-space">                </span>// Assuming no growth after year T, so NOPAT_t+1 = NOPAT_t.</p>
<p class="p1"><span class="Apple-converted-space">                </span>// NOPAT_t relative to NOPAT_0=1 is (1+g)^t</p>
<p class="p1"><span class="Apple-converted-space">                </span>const nopatT = Math.pow(1 + g, t);</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// Residual value at time T (value of a no-growth perpetuity of NOPAT_t)</p>
<p class="p1"><span class="Apple-converted-space">                </span>const residualValueT = nopatT / wacc;</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// Discount the residual value back to year 0</p>
<p class="p1"><span class="Apple-converted-space">                </span>const pvResidualValue = residualValueT / Math.pow(1 + wacc, t);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>// --- Total Implied P/E ---</p>
<p class="p1"><span class="Apple-converted-space">                </span>const impliedPE = pvFcfPeriod + pvResidualValue;</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>return { value: impliedPE };</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>function generateSingleStageSensitivityTable(params) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const { roic, g, t, wacc } = params;</p>
<p class="p1"><span class="Apple-converted-space">                </span>const waccSteps = [-1, -0.5, 0, 0.5, 1];</p>
<p class="p1"><span class="Apple-converted-space">                </span>const gSteps = [-1, -0.5, 0, 0.5, 1];</p>
<p class="p1"><span class="Apple-converted-space">                </span>let tableHtml = '&lt;table class="w-full border-collapse text-center"&gt;';</p>
<p class="p1"><span class="Apple-converted-space">                </span>tableHtml += '&lt;thead&gt;&lt;tr class="bg-gray-100"&gt;&lt;th class="p-2 border font-semibold"&gt;WACC \\ Growth&lt;/th&gt;';</p>
<p class="p1"><span class="Apple-converted-space">                </span>gSteps.forEach(step =&gt; { tableHtml += `&lt;th class="p-2 border font-semibold"&gt;${(g + step).toFixed(2)}%&lt;/th&gt;`; });</p>
<p class="p1"><span class="Apple-converted-space">                </span>tableHtml += '&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;';</p>
<p class="p1"><span class="Apple-converted-space">                </span>waccSteps.forEach(waccStep =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const currentWacc = wacc + waccStep;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>tableHtml += `&lt;tr&gt;&lt;td class="p-2 border font-semibold bg-gray-100"&gt;${currentWacc.toFixed(2)}%&lt;/td&gt;`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>gSteps.forEach(gStep =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>const currentG = g + gStep;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>const result = calculateSingleStagePE(roic, currentG, t, currentWacc);</p>
<p class="p1"><span class="Apple-converted-space">                        </span>let val = (result.value &amp;&amp; isFinite(result.value)) ? result.value.toFixed(2) : 'N/A';</p>
<p class="p1"><span class="Apple-converted-space">                        </span>tableHtml += `&lt;td class="p-2 border ${waccStep === 0 &amp;&amp; gStep === 0 ? 'highlight-cell' : ''}"&gt;${val}&lt;/td&gt;`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>});</p>
<p class="p1"><span class="Apple-converted-space">                    </span>tableHtml += '&lt;/tr&gt;';</p>
<p class="p1"><span class="Apple-converted-space">                </span>});</p>
<p class="p1"><span class="Apple-converted-space">                </span>tableHtml += '&lt;/tbody&gt;&lt;/table&gt;';</p>
<p class="p1"><span class="Apple-converted-space">                </span>ss.tableContainer.innerHTML = tableHtml;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>function updateSingleStageUI() {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const params = {};</p>
<p class="p1"><span class="Apple-converted-space">                </span>for (const key in ss.inputs) { params[key] = parseFloat(ss.inputs[key].num.value); }</p>
<p class="p1"><span class="Apple-converted-space">                </span>const result = calculateSingleStagePE(params.roic, params.g, params.t, params.wacc);</p>
<p class="p1"><span class="Apple-converted-space">                </span>if (result.error) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>showError(ss.errorContainer, result.error);</p>
<p class="p1"><span class="Apple-converted-space">                    </span>ss.resultsContainer.classList.add('hidden');</p>
<p class="p1"><span class="Apple-converted-space">                </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>hideError(ss.errorContainer);</p>
<p class="p1"><span class="Apple-converted-space">                    </span>ss.resultsContainer.classList.remove('hidden');</p>
<p class="p1"><span class="Apple-converted-space">                    </span>displayResult(ss.peResultEl, result.value);</p>
<p class="p1"><span class="Apple-converted-space">                    </span>generateSingleStageSensitivityTable(params);</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// --- Tab Switching Logic ---</p>
<p class="p1"><span class="Apple-converted-space">            </span>const tabButtons = document.querySelectorAll('.tab-btn');</p>
<p class="p1"><span class="Apple-converted-space">            </span>const modelContents = document.querySelectorAll('.model-content');</p>
<p class="p1"><span class="Apple-converted-space">            </span>tabButtons.forEach(button =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>button.addEventListener('click', () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>tabButtons.forEach(btn =&gt; btn.classList.remove('active'));</p>
<p class="p1"><span class="Apple-converted-space">                    </span>button.classList.add('active');</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const model = button.getAttribute('data-model');</p>
<p class="p1"><span class="Apple-converted-space">                    </span>modelContents.forEach(content =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>content.classList.toggle('hidden', content.id !== `${model}-model`);</p>
<p class="p1"><span class="Apple-converted-space">                    </span>});</p>
<p class="p1"><span class="Apple-converted-space">                    </span>// Recalculate when switching tabs</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (model === 'two-stage') {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>updateTwoStageUI();</p>
<p class="p1"><span class="Apple-converted-space">                    </span>} else if (model === 'single-stage') {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>updateSingleStageUI();</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p1"><span class="Apple-converted-space">                </span>});</p>
<p class="p1"><span class="Apple-converted-space">            </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// --- Initial Setup ---</p>
<p class="p1"><span class="Apple-converted-space">            </span>for (const key in ts.inputs) { linkInputs(ts.inputs[key].num, ts.inputs[key].slider, updateTwoStageUI); }</p>
<p class="p1"><span class="Apple-converted-space">            </span>for (const key in ss.inputs) { linkInputs(ss.inputs[key].num, ss.inputs[key].slider, updateSingleStageUI); }</p>
<p class="p1"><span class="Apple-converted-space">            </span>ts.form.addEventListener('submit', (e) =&gt; e.preventDefault());</p>
<p class="p1"><span class="Apple-converted-space">            </span>ss.form.addEventListener('submit', (e) =&gt; e.preventDefault());</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Initial calculation for the default visible model</p>
<p class="p1"><span class="Apple-converted-space">            </span>updateTwoStageUI();</p>
<p class="p1"><span class="Apple-converted-space">        </span>});</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/script&gt;</p>
<p class="p1">&lt;/body&gt;</p>
<p class="p1">&lt;/html&gt;</p>
</body>
</html>
